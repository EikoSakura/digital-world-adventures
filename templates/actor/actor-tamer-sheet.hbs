<form class="{{cssClass}} flexcol" autocomplete="off">
  <header class="sheet-header">
    <div class="tamer-section">
      <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}"/>
      <div class="header-fields">
        <h1><input name="name" type="text" value="{{actor.name}}" placeholder="Tamer Name"/></h1>
        <div class="resources flexrow">
          <div class="resource">
            <label>HP</label>
            <input type="text" name="system.hp.value" value="{{system.hp.value}}" data-dtype="Number"/>
            / {{system.hp.max}}
          </div>
          <div class="resource">
            <label>Digisoul</label>
            <input type="text" name="system.digisoul.value" value="{{system.digisoul.value}}" data-dtype="Number"/>
            / {{system.digisoul.max}}
          </div>
          <div class="resource">
            <label>Bits</label>
            <input type="text" name="system.bits" value="{{system.bits}}" data-dtype="Number"/>
          </div>
        </div>
        <div class="defenses flexrow">
          <div><label>Defense:</label> {{system.defense.value}}</div>
          <div><label>Magic Defense:</label> {{system.magicDefense.value}}</div>
        </div>
      </div>
    </div>
    {{#if partner}}
    <div class="partner-section">
      <img class="profile-img partner-img" src="{{partner.img}}" title="{{partner.name}}"/>
      <div class="partner-fields">
        <h2>{{partner.name}}</h2>
        <div class="partner-info">
          <span class="species">{{partner.system.species}}</span>
          <span class="stage">{{partner.system.stage}}</span>
        </div>
        <div class="resources flexrow">
          <div class="resource">
            <label>HP</label>
            {{partner.system.hp.value}} / {{partner.system.hp.max}}
          </div>
          <div class="resource">
            <label>Digisoul</label>
            {{partner.system.digisoul.value}} / {{partner.system.digisoul.max}}
          </div>
        </div>
        <div class="defenses flexrow">
          <div><label>Def:</label> {{partner.system.defense.value}}</div>
          <div><label>MDef:</label> {{partner.system.magicDefense.value}}</div>
        </div>
        <button type="button" class="open-partner-sheet" data-actor-id="{{partner._id}}">
          Open Partner Sheet
        </button>
      </div>
    </div>
    {{else}}
    <div class="partner-section no-partner">
      <p>No Partner Selected</p>
      <button type="button" class="select-partner">Select Partner Digimon</button>
    </div>
    {{/if}}
  </header>

  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item" data-tab="tamer">Tamer</a>
    {{#if partner}}
    <a class="item" data-tab="partner">Partner</a>
    {{/if}}
    <a class="item" data-tab="items">Items</a>
    <a class="item" data-tab="bio">Biography</a>
  </nav>

  <section class="sheet-body">
    <!-- Tamer Stats Tab -->
    <div class="tab tamer" data-group="primary" data-tab="tamer">
      <h3>Crest</h3>
      <select name="system.crest.type">
        <option value="courage" {{#if (eq system.crest.type "courage")}}selected{{/if}}>Courage</option>
        <option value="friendship" {{#if (eq system.crest.type "friendship")}}selected{{/if}}>Friendship</option>
        <option value="love" {{#if (eq system.crest.type "love")}}selected{{/if}}>Love</option>
        <option value="knowledge" {{#if (eq system.crest.type "knowledge")}}selected{{/if}}>Knowledge</option>
        <option value="sincerity" {{#if (eq system.crest.type "sincerity")}}selected{{/if}}>Sincerity</option>
        <option value="reliability" {{#if (eq system.crest.type "reliability")}}selected{{/if}}>Reliability</option>
        <option value="hope" {{#if (eq system.crest.type "hope")}}selected{{/if}}>Hope</option>
        <option value="light" {{#if (eq system.crest.type "light")}}selected{{/if}}>Light</option>
        <option value="kindness" {{#if (eq system.crest.type "kindness")}}selected{{/if}}>Kindness</option>
      </select>

      <h3>Parameters</h3>
      {{#each system.parameters as |param key|}}
      <div class="parameter flexrow">
        <label>{{param.label}}</label>
        <input type="text" name="system.parameters.{{key}}.value" value="{{param.value}}" data-dtype="Number"/>
      </div>
      {{/each}}

      <h3>Skills</h3>
      {{#each system.skills as |category catKey|}}
      <h4>{{catKey}}</h4>
      {{#each category as |skill skillKey|}}
      <div class="skill flexrow">
        <label>{{skill.label}}</label>
        <input type="text" name="system.skills.{{catKey}}.{{skillKey}}.value" value="{{skill.value}}" data-dtype="Number"/>
      </div>
      {{/each}}
      {{/each}}

      <h3>Talents</h3>
      <div class="item-controls">
        <a class="item-create" data-type="talent">Add Talent</a>
      </div>
      <ol class="items-list">
        {{#each talents as |item|}}
        <li class="item" data-item-id="{{item._id}}">
          <img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/>
          <h4>{{item.name}}</h4>
          <div class="item-controls">
            <a class="item-control item-edit"><i class="fas fa-edit"></i></a>
            <a class="item-control item-delete"><i class="fas fa-trash"></i></a>
          </div>
        </li>
        {{/each}}
      </ol>
    </div>

    <!-- Partner Stats Tab -->
    {{#if partner}}
    <div class="tab partner" data-group="primary" data-tab="partner">
      <div class="partner-header">
        <h2>{{partner.name}}</h2>
        <div class="partner-details">
          <span><strong>Species:</strong> {{partner.system.species}}</span>
          <span><strong>Stage:</strong> {{partner.system.stage}}</span>
          <span><strong>Attribute:</strong> {{partner.system.attribute}}</span>
          <span><strong>Element:</strong> {{partner.system.element}}</span>
        </div>
      </div>

      <h3>Parameters</h3>
      {{#each partner.system.parameters as |param key|}}
      <div class="parameter flexrow">
        <label>{{param.label}}</label>
        <span>{{param.value}}</span>
      </div>
      {{/each}}

      <h3>Abilities</h3>
      <ol class="items-list">
        {{#each partnerAbilities as |item|}}
        <li class="item" data-item-id="{{item._id}}">
          <img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/>
          <h4>{{item.name}}</h4>
          <p class="item-description">{{item.system.description}}</p>
        </li>
        {{/each}}
      </ol>

      <h3>Attacks</h3>
      <ol class="items-list">
        {{#each partnerAttacks as |item|}}
        <li class="item" data-item-id="{{item._id}}">
          <img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/>
          <h4 class="rollable partner-attack" data-roll-type="attack" data-actor-id="{{partner._id}}" data-item-id="{{item._id}}">{{item.name}}</h4>
          <div class="attack-details">
            <span>Intensity: {{item.system.intensity}}</span>
            <span>Range: {{item.system.range}}</span>
            <span>Element: {{item.system.element}}</span>
          </div>
        </li>
        {{/each}}
      </ol>
    </div>
    {{/if}}

    <!-- Items Tab -->
    <div class="tab items" data-group="primary" data-tab="items">
      <h3>Equipment</h3>
      <div class="item-controls">
        <a class="item-create" data-type="equipment">Add Equipment</a>
      </div>
      <ol class="items-list">
        {{#each equipment as |item|}}
        <li class="item" data-item-id="{{item._id}}">
          <img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/>
          <h4>{{item.name}}</h4>
          <div class="item-controls">
            <a class="item-control item-edit"><i class="fas fa-edit"></i></a>
            <a class="item-control item-delete"><i class="fas fa-trash"></i></a>
          </div>
        </li>
        {{/each}}
      </ol>

      <h3>Consumables</h3>
      <div class="item-controls">
        <a class="item-create" data-type="consumable">Add Consumable</a>
      </div>
      <ol class="items-list">
        {{#each consumables as |item|}}
        <li class="item" data-item-id="{{item._id}}">
          <img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/>
          <h4>{{item.name}}</h4>
          <span>x{{item.system.quantity}}</span>
          <div class="item-controls">
            <a class="item-control item-edit"><i class="fas fa-edit"></i></a>
            <a class="item-control item-delete"><i class="fas fa-trash"></i></a>
          </div>
        </li>
        {{/each}}
      </ol>

      <h3>Assets</h3>
      <div class="item-controls">
        <a class="item-create" data-type="asset">Add Asset</a>
      </div>
      <ol class="items-list">
        {{#each assets as |item|}}
        <li class="item" data-item-id="{{item._id}}">
          <img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/>
          <h4>{{item.name}}</h4>
          <div class="item-controls">
            <a class="item-control item-edit"><i class="fas fa-edit"></i></a>
            <a class="item-control item-delete"><i class="fas fa-trash"></i></a>
          </div>
        </li>
        {{/each}}
      </ol>
    </div>

    <!-- Biography Tab -->
    <div class="tab bio" data-group="primary" data-tab="bio">
      <h3>Tamer Biography</h3>
      {{editor system.biography target="system.biography" button=true owner=owner editable=editable}}

      {{#if partner}}
      <h3>Partner Biography</h3>
      <div class="partner-biography">
        {{{partner.system.biography}}}
      </div>
      {{/if}}
    </div>
  </section>
</form>
